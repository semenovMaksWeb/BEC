[
  {
    "key": ["url_catalog"],
    "type": "convert",
    "convert": {
      "type": "constValue",
      "params": {
        "const_value": {
          "type": "properties",
          "properties": "url.static"
        }
      }
    }
  },
  {
    "key": ["url_catalog"],
    "type": "convert",
    "convert": {
      "type": "afterAdd",
      "params": {
        "value": {
          "type": "value",
          "value": "\\files\\\\"
        }
      }
    }
  },
  {
    "key": ["file_name"],
    "type": "convert",
    "convert": {
      "type": "constValue",
      "params": {
        "const_value": {
          "type": "value",
          "value": "1.xlsx"
        }
      }
    }
  },
  {
    "key": ["sql"],
    "type": "postgresql",
    "sql": {
      "text": "select * from tec.user"
    }
  },
  {
    "key": ["excel"],
    "type": "excel",
    "excel":  {
      "typeExcel": "xlsx",
      "operation": [
        {
          "key": ["sheet"],
          "type": "createSheet",
          "params": {
            "name": {
              "type": "value",
              "value": "Пользователь"
            }
          }
        },
        {
          "key": null,
          "type": "createRowArrayCell",
          "params": {
            "sheet": {
              "type": "dataset",
              "key": ["sheet"]
            },
            "row": {
              "type": "value",
              "value": 0
            },
            "value": {
              "type": "value",
              "value": ["Индификатор", "Ник", "Почта"]
            }
          }
        },
        {
          "type": "generatorDataExcel",
          "params": {
            "sheet": {
              "type": "dataset",
              "key": ["sheet"]
            },
            "column": {
              "type": "value",
              "value": ["id", "nik", "email"]
            },
            "row": {
              "type": "value",
              "value": 1
            },
            "data": {
              "type": "dataset",
              "key": ["sql"]
            }
          }
        },
        {
          "type": "saveExcelResponse",
          "key": ["result_excel"],
          "params": {
            "name": {
              "type": "value",
              "value": "Отчет_по_пользователям.xlsx"
            }
          }
        },
        {
          "type": "saveExcelFile",
          "params": {
            "url": {
              "type": "dataset",
              "key": ["url_catalog"]
            },
            "name": {
              "type": "dataset",
              "key": ["file_name"]
            }
          }
        }
      ]
    }
  },
  {
    "type": "return",
    "key": ["result_excel"]
  }
]