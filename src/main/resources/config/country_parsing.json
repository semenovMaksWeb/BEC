[
  {
    "key": ["html_doc"],
    "type": "parsing_html",
    "parsingSite": {
      "type": "connectSite",
      "params": {
        "url": {
          "type": "value",
          "value": "https://www.komandirovka.ru/countries"
        }
      }
    }
  },
  {
    "key": ["html_list"],
    "type": "parsing_html",
    "parsingSite": {
      "type": "selectElements",
      "params": {
        "select": {
          "type": "value",
          "value": ".alpha__flags .alpha__flag"
        },
        "element": {
          "type": "dataset",
          "key": ["html_doc"]
        }
      }
    }
  },
  {
    "key": ["for"],
    "type": "foreach",
    "foreach": {
      "elem": ["html_elem"],
      "list": ["html_list"]
    },
    "children": [
      {
        "key": ["html_name"],
        "type": "parsing_html",
        "parsingSite": {
          "type": "selectElement",
          "params": {
            "select": {
              "type": "value",
              "value": ".alpha__flag-txt"
            },
            "element": {
              "type": "dataset",
              "key": ["html_elem"]
            }
          }
        }
      },
      {
        "key": ["html_capital"],
        "type": "parsing_html",
        "parsingSite": {
          "type": "selectElement",
          "params": {
            "select": {
              "type": "value",
              "value": ".alpha__links div:nth-of-type(3) a"
            },
            "element": {
              "type": "dataset",
              "key": ["html_elem"]
            }
          }
        }
      },
      {
        "key": ["html_flag"],
        "type": "parsing_html",
        "parsingSite": {
          "type": "selectElement",
          "params": {
            "select": {
              "type": "value",
              "value": "img"
            },
            "element": {
              "type": "dataset",
              "key": ["html_elem"]
            }
          }
        }
      },
      {
        "key": ["name"],
        "type": "parsing_html",
        "parsingSite": {
          "type": "selectElementText",
          "params": {
            "element": {
              "type": "dataset",
              "key": ["html_name"]
            }
          }
        }
      },
      {
        "key": ["capital"],
        "type": "parsing_html",
        "parsingSite": {
          "type": "selectElementText",
          "params": {
            "element": {
              "type": "dataset",
              "key": ["html_capital"]
            }
          }
        }
      },
      {
        "key": ["flag"],
        "type": "parsing_html",
        "parsingSite": {
          "type": "selectElementAttr",
          "params": {
            "element": {
              "type": "dataset",
              "key": ["html_flag"]
            },
            "attr": {
              "type": "value",
              "value": "data-src"
            }
          }
        }
      },
      {
        "key": ["flag"],
        "type": "convert",
        "convert": {
          "type": "beforeAdd",
          "params": {
            "value": {
              "type": "value",
              "value": "https://www.komandirovka.ru"
            }
          }
        }
      },
      {
        "key": ["sql"],
        "type": "postgresql",
        "sql": {
          "convert": "object",
          "text": "select * from libs.country_insert(_name => ?, _capital => ?, _flag => ?)",
          "params": [
            {
              "data": {
                "type": "dataset",
                "key": ["name"]
              },
              "type": "String",
              "index": 1
            },
            {
              "type": "String",
              "data": {
                "type": "dataset",
                "key": ["capital"]
              },
              "index": 2
            },
            {
              "type": "String",
              "data": {
                "type": "dataset",
                "key": ["flag"]
              },
              "index": 3
            }
          ]
        }
      }
    ]
  }
]